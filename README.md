# Elevator Simulator

エレベーターの群制御問題について

## 問題設定

* $N$階あるビルがある。各階を$0$階、$1$階、$\dots$、$N-1$階とする。
* $M$基のエレベーターがビルに存在している。各エレベーターをエレベーター$0, 1, \dots, M-1$とする。はじめ、すべてのエレベーターは$\lfloor \frac{N}{2}\rfloor$にある。各基が載せられる乗客は$C$人である。
* $T$ターンのゲームを行う。それによって計算されるスコアを最小化したい。
  * 各ターン、状況が標準入力で与えられる。
  * それに対して、各エレベーターの動きを出力する。`UP`、`DOWN`、`STAY`、`OPEN`の4つのいずれかを選択する必要がある。
    * `UP`: エレベーター$i$が$j$階にいるとき、次のターンは$\min(j+1, N-1)$階に移動する。
    * `DOWN`: エレベーター$i$が$j$階にいるとき、次のターンは$\max(j-1, 0)$階に移動する。
    * `STAY`: エレベーター$i$が$j$階にいるとき、次のターンも$j$階に存在する。
    * `OPEN`: エレベーター$i$が$j$階にいるとき、目的地が$j$階である乗客をすべて降ろす。続けて、載せる乗客の添字を出力して、その添字の乗客を載せる。(例: `OPEN 0 3`)
      * 目的地が$j$階である乗客をすべて降ろしたあと、出力された添字の乗客を載せる。
* スコアは、乗客が生成されたターン$a$、その乗客が載っているエレベーターが目的の階に到着し、`OPEN`が出力されたターン$b$を用いて$(b - a)^2$のすべての乗客の和によって計算される。ただし、ゲーム終了時に降りていない客については、生成されてから、ゲーム終了までの時間の二乗$(T - a)^2$とする。

## 入出力

* $N = 10$
* $M = 3$
* $C = 10$
* $T = 100$
* 各ターン$t$に増加する待ち人数の数はすべての階で独立に$\text{Po}(\lambda)$に従う。
  * $\lambda = 0.1$である。
* $i$階で発生する待ち乗客の目的地は、$i$階以外のすべての階から一様ランダムに選択される。

### はじめのターンの入力

はじめ、一度だけ以下の情報が標準入力で与えられる。

$N$ $M$ $C$ $T$ $\lambda$  

### 各ターンの入力

毎ターン、以下の情報が標準入力で与えられる。

$h_i$: $i$基目のエレベーターが今いる階  
$k_i$: $i$基目のエレベーターに乗っている乗客の数  
$q_i^{j}$: $j$基目のエレベーターの$i$番目の乗客の目的にしている階  
$s_i^{j}$: $j$基目のエレベーターの$i$番目の乗客の待機時間  
$p_i^{j}$: 階$j$の$i$番目の待ち乗客の目的にしている階  
$t_i^{j}$: 階$j$の$i$番目の待ち乗客の待機時間  

以下の形式で与えられる。

$h_0 h_1 \dots h_{M-1}$  
$k_0 \space q_{0}^{0} \space s_{0}^{0} \space q_{1}^{0} \space s_{1}^{0} \space \dots \space q_{k_0 - 1}^{0} \space s_{k_0 - 1}^{0}$  
$k_1 \space q_{0}^{1} \space s_{0}^{1} \space q_{1}^{1} \space s_{1}^{1} \space \dots \space q_{k_1 - 1}^{1} \space s_{k_1 - 1}^{1}$    
$\dots$  
$k_{M-1} \space q_{0}^{M-1} \space s_{0}^{M-1} \space q_{1}^{M-1} \space s_{1}^{M-1} \space \dots \space q_{k_{M-1} - 1}^{1} \space s_{k_{M-1} - 1}^{1}$  
$l_0 \space p_0^0 \space t_0^0 \space p_1^0 \space t_1^0 \space \dots \space p_{l_0 - 1}^0 \space t_{l_0 - 1}^0$  
$l_1 \space p_0^1 \space t_0^1 \space p_1^1 \space t_1^1 \space \dots \space p_{l_1 - 1}^1 \space t_{l_1 - 1}^1$  
$\dots$  
$l_{N-1} \space p_0^{N-1} \space t_0^{N-1} \space p_1^{N-1} \space t_1^{N - 1} \space \dots \space p_{l_{N-1} - 1}^{N-1} \space t_{l_{N-1} - 1}^{N-1}$

### 各ターンの出力

$M$行出力する。$i$行目には、$i$基目のエレベーターの動作を出力する。

また、$i, j (i < j)$基目のエレベーターが同じ階にあり、同じ乗客を載せるような出力を行ったときは、$i$基目のエレベーターに載ることにする。

容量を超えて載せようとした場合は、スコアは無限大となる。

## ローカルでの実行

### 入力の生成

`cargo run --bin generate_input start end`でseedが`start`のものから`end`のものまで入力を生成する。

入力ファイルは以下のような形式になっている。ただし、$p_i^{j}$は$j$ターン目に$i$階に発生する待ち乗客の数である。

$N$ $M$ $C$ $T$  
$p_0^{0} p_0^{1} \dots p_0^{T-1}$  
$p_1^{0} p_1^{1} \dots p_1^{T-1}$  
$\dots$
$p_{N-1}^{0} p_{N-1}^{1} \dots p_{N-1}^{T-1}$

### ローカルジャッジ

`cargo run --bin local_judge input.txt command`の形式でローカルでプログラム`command`を実行し、出力を得ることができる。

### ビジュアライズ

TODO

## ライセンス

[MIT](LICENSE)
